import os
from selenium import webdriver
from selenium.webdriver.common.action_chains import ActionChains
import time

# 1. 들어가기 //*[@id="appmanager_recentpostswidget-2"]/div[1]/div[1]/div[1]/div/div[3]/div/div[2]/a/svg/use
# 2. 들어가기 2 //*[@id="content"]/div[4]/div[2]/div/div[2]/div[5]/a/svg
# 2-1 뒤로가기 2번
# 3. 다운로드 링크 리스트화 //*[@id="file"]/div[1]/div[2]/div/a
# 4 . 일정 횟수되면 next 버튼

os.chdir('D://apk//정상샘플')
chromdriver = 'chromedriver.exe'



options = webdriver.ChromeOptions()
options.add_experimental_option("excludeSwitches", ["enable-logging"])
browser = webdriver.Chrome(options=options)
actions = ActionChains(browser)
browser.get("https://www.apkmirror.com/")  # apkmirror 사이트 접속


xpath_list=[]
time.sleep(7)
os.chdir('E://프로젝트//good_sample')
avb=[]
def download():
    for i in range(1,251):
        xpath_list.append(str('//*[@id="file"]/div[1]/div[2]/div/a'))
    for c in xpath_list:
        avb.append(browser.find_element_by_xpath(c).get_attribute('href')) # 다운로드 주소 리스트 축적
        time.sleep(0.3)

while(1):
    try:
        time.sleep(2)
        crawler()
        next = browser.find_element_by_xpath('//*[@id="samples_next"]/a')
        next.click()
    except:
        break

for x in avb:
    browser.get(x)
    time.sleep(2)
    try:
        download = browser.find_element_by_xpath('//*[@id="dl_sample"]')
        download.click()
        time.sleep(3)
    except:
        pass

print("sampe :",len(avb))
print("Done")
