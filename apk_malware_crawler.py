import os
from selenium import webdriver
from selenium.webdriver.common.action_chains import ActionChains
import time



os.chdir('C://Users//SCHCSRC//Desktop//업무//VSC')
chromdriver = 'chromedriver.exe'



options = webdriver.ChromeOptions()
options.add_experimental_option("excludeSwitches", ["enable-logging"])
browser = webdriver.Chrome(options=options)
actions = ActionChains(browser)
browser.get("https://bazaar.abuse.ch/browse.php?search=tag%3Aapk")  # bazzar 사이트 접속


xpath_list=[]
time.sleep(7)
os.chdir('E://프로젝트//apk_sample')
avb=[]
def crawler():
    for i in range(1,251):
        xpath_list.append(str('//*[@id="samples"]/tbody/tr['+str(i)+']/td[7]/a'))
    for c in xpath_list:
        avb.append(browser.find_element_by_xpath(c).get_attribute('href'))
        time.sleep(0.3)

while(1):
    try:
        time.sleep(2)
        crawler()
        next = browser.find_element_by_xpath('//*[@id="samples_next"]/a')
        next.click()
    except:
        break

for x in avb:
    browser.get(x)
    time.sleep(2)
    try:
        download = browser.find_element_by_xpath('//*[@id="dl_sample"]')
        download.click()
        time.sleep(3)
    except:
        pass

print("sampe :",len(avb))
print("Done")